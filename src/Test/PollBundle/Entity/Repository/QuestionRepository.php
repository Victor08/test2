<?php

namespace Test\PollBundle\Entity\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * QuestionRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class QuestionRepository extends EntityRepository
{
    public function getQuestionsForTest($testId, $approved = true)
    {
        $qb = $this->createQueryBuilder('q')
                   ->select('q')
                   ->where('q.testId = :test_id')
                   ->addOrderBy('q.id')
                   ->setParameter('test_id', $testId);

       

        return $qb->getQuery()
                  ->getResult();
   /*     
        for ($i=0; $i<count(  $questions ) ; $i++)
        {
            $qb = $this->createQueryBuilder('a')
                       ->select('a')
                       ->where('a.question = :question_id')
                       ->addOrderBy('a.id')
                       ->setParameter('question_id', $questions[$i]['id']);
            $question[$i]['answers'] = $qb->getQuery()
                                          ->getResult();
                       
        }
    * */
    
    }
    
    public function getQuestionsForTestArray($testId, $approved = true)
    {
        $qb = $this->createQueryBuilder('q')
                   ->select('q')
                   ->where('q.testId = :test_id')
                   ->addOrderBy('q.id')
                   ->setParameter('test_id', $testId);

       

        return $qb->getQuery()
                  ->getArrayResult();
    }
    
    public function getQuestionIdsForTest($testId, $approved = true)
    {
        $qb = $this->createQueryBuilder('q')
                   ->select('q.id')
                   ->where('q.testId = :test_id')
                   ->addOrderBy('q.id')
                   ->setParameter('test_id', $testId);

       

        return $qb->getQuery()
                  ->getArrayResult();
    }
}
